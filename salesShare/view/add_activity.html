<!DOCTYPE html>
<html>

	<head>
		<title>jQuery WeUI</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

		<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">

		<link rel="stylesheet" href="../css/framework/weui/weui.css">
		<link rel="stylesheet" href="../css/framework/weui/jquery-weui.css">
		<link rel="stylesheet" href="../css/layouts/common.css">

		<link rel="stylesheet" href="../js/plugins/jquery.zyUpload/control/css/zyUpload.css" type="text/css">
		
		<link rel="stylesheet" href="../js/plugins/jquery.minicolors/jquery.minicolors.css">

		<style type="text/css">
			video,
			img {
				width: 100%;
			}
			
			.container {
				background-color: antiquewhite;
				margin-bottom: 110px;
				padding-bottom: 20px;
			}
			
			.head-banner {
				background-color: #fff;
			}
			
			.module {}
			
			.module .title {
				text-align: center;
				height: 30px;
				margin: 10px auto;
				background-color: #26d624;
				width: 30%;
				color: #fff;
				line-height: 30px;
			}
			
			.module .content {
				width: 90%;
				margin: auto;
				background: #fff;
				padding: 5px;
			}
			
			.upload-panel {
				width: 90%;
				height: 70px;
				border: 2px dashed #ddd;
				margin: 4% auto;
				text-align: center;
				line-height: 70px;
				display: flex;
				justify-content: space-around;
				color: #8e8e8e;
			}
			
			.upload-panel.preview {
				display: none;
			}
			
			.upload-panel .clear,
			.upload-panel .video,
			.upload-panel .image,
			.upload-panel .text {
				display: inline-block;
				/* margin-right: 1%; */
				border: 1px solid #ddd;
				height: 40px;
				margin: auto;
				line-height: 40px;
				padding: 0px 6px;
				border-radius: 5px;
				font-size: 14px;
			}
			
			.upload-panel .clear,
			.upload-panel .edit {
				display: none;
			}
			
			.module .upload-panel .image {}
			
			.module .content .source {
				padding: 4%;
				border: 1px dashed #ccc;
				margin: 3%;
			}
			
			.module .content .source.preview {
				padding: 0%;
				border: none;
				margin: 3%;
			}
			
			.source .hand-trigger {
				position: absolute;
				background-color: #000;
				color: #fff;
				opacity: 0.6;
				margin-left: 62%;
				margin-top: -3%;
				/* float: right; */
				/* text-align: right; */
				padding: 2% 5%;
				/* border-radius: 0px 0px 0px 90px; */
			}
			
			.head-banner .hand-trigger {
				margin-left: 75%;
				margin-top: 0%;
			}
			
			
			#startTime,
			#endTime{
				width: 44%;
			}
			.cut-fill{
				width: 20%;
				text-indent: 20%;
			}
			
			.source .hand-trigger.preview {
				display: none;
			}
			
			.source .img {}
			
			.source .txt {}
			
			.source .video {}
			
			.form-handle {
				position: fixed;
				bottom: -1px;
				width: 100%;
				/* background-color: #3d4145; */
				text-align: center;
				/* opacity: .8; */
				color: #fff;
			}
			
			.form-handle .mode {
				/* position: absolute; */
				/* color: #fff; */
				opacity: .85;
				background-color: #3d4145;
			}
			
			.form-handle .mode .weui-cell_switch {
				padding-top: 12px;
			}
			
			.form-handle .mode .weui-cell__ft {
				text-align: center;
				margin: auto;
				/* width: 100%; */
				line-height: 32px;
			}
			
			.form-handle .mode .weui-cell__ft label {
				color: #fff;
				vertical-align: top;
				/* width: 202px; */
				margin: auto 20px;
				font-size: 20px;
			}
			
			.form-handle .save {
				background-color: orange;
				height: 55px;
				line-height: 55px;
				font-size: 24px;
				letter-spacing: 4px;
			}
			
			.form-handle a {
				color: #fff;
				font-size: 30px;
				letter-spacing: 6px;
			}
			
			#section_1.preview {
				display: none;
			}
			
			#section_top {
				margin-top: 20px;
				display: none;
			}
			
			#section_top.preview {
				display: block;
			}
			#section_0.preview {
				display: none;
			}
			.edit-title.preview {
				display: none;
			}
			
			#section_top .price {
				margin: 20px;
				display: flex;
				justify-content: space-around;
			}
			
			#section_top .join {
				width: 40%;
				text-align: center;
				margin: auto;
				background-color: orange;
				color: #fff;
				margin-bottom: 20px;
				height: 36px;
				line-height: 36px;
				border-radius: 31px;
			}
			
			#section_top .join a {
				color: #fff;
			}
			
			#uploadBannerForm {
				position: absolute;
				top: 0px;
				text-align: center;
				width: 100%;
			}
			
			.edit-title {
				border: 2px dashed #adadad !important;
				background-color: #ffffff !important; 
				color: #a9a9a9 !important;
				text-indent: 7%;
			}
			
			.count-down,
			.main-title {
				display: none;
			}
			
			
			.count-down.preview,
			.main-title.preview {
				display: block;
			}
			
			#addTxt .btns,
			#uploadImg .btns {
				display: flex;
				justify-content: space-around;
				position: relative;
			}
			#addTxt .btns a,
			#uploadImg .btns a {
				width: 40%;
				margin-top: 15px;
			}
			
			/*text editor*/
			#txt_css_render{
				width: 100%;
			    font-size: 14px;
			    position: fixed;
			    top: 0px;
			    right: 0px;
				background-color: #3d4145;
   			 	color: #fff;
   			 	display: none;
   			 	opacity: .85;
			}
			#txt_css_render a{
    			text-decoration: none;
    			color: #fff;
			}
			#txt_css_render p{
				
			}
			#txt_css_render p.item1{
				
			}
			#txt_css_render p.item2{
				
			}
			#txt_css_render p.item3{
				
			}
			#txt_css_render p.item4{
				
			}
			#txt_css_render .color-slot a{
				padding: 10px 12px;
			}
			
			
			#txt_css_render p.item{
				width: 90%;
				margin: 10px auto;
				display: flex;
    			justify-content: space-between;
			}
			.color-slots,
			.font-warehouse{
				 width: 90%;
    			margin: 10px auto;
			}
			  
			  .color-slot{
			  	
			  } 
			.color-slots a>div,
			.font-warehouse div{
				display: inline-block;
			}
			.color-slots a>div{
				width: 20px;
				height: 20px;
				border-radius: 10px;
			}
			
			.minicolors-theme-default .minicolors-input{
				height: 26px;
			}
			#txt_css_render a.selected-item{
			    color: #ffa500;
   				 font-weight: bold;	
			}
			textarea{
				width: 100%;
				border: none;
			}
			.hide-panel{
				text-align: center;
    			margin: 10px;
			}
			
		</style>
		<link rel="stylesheet" href="../css/layouts/template.css">
	</head>
	<script src="../js/libs/vue/vue.js"></script>
	<script src="../js/libs/jquery/jquery-2.1.4.js"></script>
	<!-- 引用核心层插件 -->
	<script src="../js/plugins/jquery.zyUpload/core/zyFile.js"></script>
	<!-- 引用控制层插件 -->
	<script src="../js/plugins/jquery.zyUpload/control/js/zyUpload.js"></script>
	<!-- 引用初始化JS -->
	<script src="../js/plugins/jquery.zyUpload/core/upload.js"></script>

	<script src="../js/plugins/json/json2.js"></script>
	<!--<script src="../js/libs/vue/vue.js"></script>-->

	<script src="../js/common.js"></script>
	<script src="../js/config.js"></script>

	<script type="text/javascript" src="../js/plugins/froala-editor/codemirror.min.js"></script>
	<script type="text/javascript" src="../js/plugins/froala-editor/froala_editor.pkgd.min.js"></script>
	<script type="text/javascript" src="../js/plugins/froala-editor/xml.min.js"></script>

	<script src="../js/plugins/jquery.downCount/jquery.downCount.js"></script>
	
	<script src="../js/plugins/jquery.minicolors/jquery.minicolors.js"></script>

	<body ontouchstart>

		<header class='demos-header'>
			<h1 class="demos-title"></h1>
		</header>

		<div id="activityVue" class="container">
			<div id="head_banner" class="head-banner">
				<div class="content">
					<div id="head" class="source">
						<div class="hand-trigger open-popup" data-target="#select_banner">替换</div>
						<div :src="headUrl" class="img">
							<img id="defaultBanner" :src="headUrl" alt="">
							<!--<img id="previewBanner" class="hide" alt="">
		<form class="hide" id="uploadBannerForm" enctype="multipart/form-data" method="post">
		 
		  <input type="hidden" name="unique" :value="headId"><br />
		  <input type="hidden" name="activityTypeId" /><br />
		  <input type="hidden" name="shopUserId"/><br />
	
		  <input class="hide" id="uploadBanner" type="file" name="file" onchange="uploadUtil.img_preview(this)" required />
		  <input type="submit" value="确认上传" />
		  <input type="button" value="取消上传" />
		</form>-->

						</div>
					</div>

				</div>

			</div>

			<div class="main-title">
				{{title}}
			</div>

			<div id="count_down" class="count-down">
				活动结束倒计时
				<span class="days">00</span>天
				<span class="hours">00</span>时
				<span class="minutes">00</span>分
				<span class="seconds">00</span>秒
			</div>

			<div id="section_top" class="module">

				<div class="content">
					<div class="price">
						<span>原价：{{cutOriginPrice}}</span>
						<span>底价：{{cutLeastPrice}}</span>
					</div>

					<div class="join">
						<a href="">我要参加</a>
					</div>

				</div>
			</div>
			<!--设置信息   砍价1-1-->
			<div id="section_0" class="module">
				<div class="title">
					设置信息
				</div>
				<div class="content">
					<div class="weui-cells">

						<div class="weui-cell">
							<div class="weui-cell__bd">
								<!--<input class="weui-input" type="text" placeholder="开始时间" v-model="source.setting.value1">-->
								<!--<label for="">活动标题</label>-->
								<input class="weui-input" type="tel" placeholder="活动标题" value="活动标题" v-model="title">
							</div>
						</div>

						<div class="weui-cell">
							<div class="weui-cell__bd">
								<!--<input class="weui-input" type="text" placeholder="开始时间" v-model="source.setting.value1">-->
								<!--<label for="">开始时间</label>-->
								<input type="text" id='startTime' placeholder="开始时间" @change="initCountDown(activityStartTime)" />
								<span>到</span>
								<input type="text" id='endTime' placeholder="结束时间" />
							</div>
						</div>


						<div class="weui-cell">
							<div class="weui-cell__bd">
								<!--<label for="">原价</label>-->
								<input class="weui-input cut-fill" type="number" placeholder="原价" v-model="cutOriginPrice" @change="refreshRelativeValues('preview_init_price',cutOriginPrice)">
								<span>元</span>
								<input class="weui-input cut-fill" type="number" placeholder="底价" v-model="cutLeastPrice" @change="refreshRelativeValues('preview_new_price',cutLeastPrice)">
								<span>元</span>
							</div>
						</div>
						<div class="weui-cell">
							<div class="weui-cell__bd">
								<!--<input class="weui-input" type="text" placeholder="单次砍价最小值" v-model="source.setting.value6">-->
								<!--<label for="">单次砍价最大值</label>-->
								<label for="">每次减价减少范围：</label>
					
							</div>
						</div>

						<div class="weui-cell">
							<div class="weui-cell__bd">
								<!--<input class="weui-input" type="text" placeholder="单次砍价最小值" v-model="source.setting.value6">-->
								<!--<label for="">单次砍价最大值</label>-->
							
								<input class="weui-input cut-fill" type="tel" placeholder="最大" v-model="cutMostPerPerson">
								<span>元</span>
								<input class="weui-input cut-fill" type="tel" placeholder="最小" v-model="cutLeastPerPerson">
								<span>元</span>
							</div>
						</div>

						<div class="weui-cell">
							<div class="weui-cell__bd">
								<!--<input class="weui-input" type="text" placeholder="单次砍价最小值" v-model="source.setting.value6">-->
								
								<span>报名者每隔</span>
									<input class="weui-input cut-fill" type="tel" placeholder="小时" v-model="redoHours">
								<span>可再次给自己减价</span>
							</div>
						</div>

					</div>
				</div>
			</div>

			<!--奖品描述 1-1-->
			<div id="section_1" class="module">
				<div class="title edit-title t-i-007">
					<input class="weui-input" type="tel" value="奖品描述" v-model="sectionOneName">
				</div>
				<div class="content">
					<div class="weui-cell">
						<div class="weui-cell__bd">

							<span>本期奖品</span>

							<input class="weui-input cut-fill" type="tel" placeholder="份数" v-model="prizeNumber">
						</div>
					</div>

					<div class="upload-panel">
						<div class="image add open-popup" data-target="#uploadImg" @click="markHandle('add','img','#section_1')">添加图片</div>
						<div class="text add open-popup"  @click="markHandle('add','txt','#section_1')">添加描述</div>

					</div>
				</div>
			</div>

			<!--活动规则 1-1-->
			<div id="section_2" class="module">
				<div class="title edit-title t-i-007">
					<input class="weui-input" type="tel" value="活动规则" v-model="sectionTwoName">
				</div>
				<div class="content">

					<div class="upload-panel">
						<div class="image add open-popup" data-target="#uploadImg" @click="markHandle('add','img','#section_2')">添加图片</div>
						<div class="text add open-popup"  @click="markHandle('add','txt','#section_2')">添加描述</div>

						<!--<div class="video add open-popup" data-target="#uploadVideo" @click="markHandle('add','video','#section_2')">添加视频</div>-->

					</div>
				</div>
			</div>

			<!--领奖信息 1-1-->
			<div id="section_3" class="module">
				<div class="title edit-title t-i-007">
					<input class="weui-input" type="tel" value="领奖信息" v-model="sectionThreeName">
				</div>
				<div class="content">

					<!--<div :id="item.id" class="source" v-for="item in source.prizeList">
				<div @click="editSourceItem(item)" class="hand-trigger open-popup" data-target="#sourceHandle">
				编辑
				</div>
				
				<div class="img" v-show="item.type==1">
					<img data-index-id="item.id" :src="item.imgUrl" alt="" />
				</div>
				<div class="txt" v-show="item.type==2">
					<p data-index-id="item.id">{{item.txt}}</p>
				</div>
				<div class="video" v-show="item.type==3">
					<video data-index-id="item.id" :src="item.videoUrl"></video>
				</div>
			
				
			</div>-->

					<div class="upload-panel">
						<div class="image add open-popup" data-target="#uploadImg" @click="markHandle('add','img','#section_3')">添加图片</div>
						<div class="text add"  @click="markHandle('add','txt','#section_3')">添加描述</div>

						<!--<div class="video add open-popup" data-target="#uploadVideo" @click="markHandle('add','video','#section_3')">添加视频</div>-->
					</div>
				</div>
			</div>

			<!--机构介绍 1-1-->
			<div id="section_4" class="module">
				<div class="title edit-title t-i-007">
					<input class="weui-input" type="tel" value="机构介绍" v-model="sectionFourName">
				</div>
				<div class="content">

					<!--<div :id="item.id" class="source" v-for="item in source.prizeList">
				<div @click="editSourceItem(item)" class="hand-trigger open-popup" data-target="#sourceHandle">
				编辑
				</div>
				
				<div class="img" v-show="item.type==1">
					<img data-index-id="item.id" :src="item.imgUrl" alt="" />
				</div>
				<div class="txt" v-show="item.type==2">
					<p data-index-id="item.id">{{item.txt}}</p>
				</div>
				<div class="video" v-show="item.type==3">
					<video data-index-id="item.id" :src="item.videoUrl"></video>
				</div>
			
				
			</div>-->

					<div class="upload-panel">
						<div class="image add open-popup" data-target="#uploadImg" @click="markHandle('add','img','#section_4')">添加图片</div>
						<div class="text add open-popup"  @click="markHandle('add','txt','#section_4')">添加描述</div>

						<!--<div class="video add open-popup" data-target="#uploadVideo" @click="markHandle('add','video','#section_4')">添加视频</div>-->
					</div>
				</div>
			</div>

			<div id="helpline" class="module">
				<div class="title">
					咨询热线
				</div>
				<div class="content">

					<div class="weui-cell__bd">
						<input class="weui-input" type="tel" placeholder="请输入电话" v-model="consultPhoneNumber">
					</div>
					<div class="weui-cell__bd">
						<div id="locationAddress"></div>
					</div>

				</div>
			</div>

			<div id="infoGathering" class="module info-item">
				<div class="title">
					信息收集设置
				</div>
				<div class="content">
					<div id="" class="weui-cell weui-cell_switch">
						<div class="weui-cell__bd">
							提示：手机号和姓名自动包含，默认必填
						</div>
					</div>

					<div class="weui-cells">
						<input class="weui-input hide" type="text" v-model="infoCollectOneName">
						<input class="weui-switch hide" type="checkbox" v-model="infoCollectOneIsRequired">
						<input class="weui-input hide" type="text" v-model="infoCollectTwoName">
						<input class="weui-switch hide" type="checkbox" v-model="infoCollectTwoIsRequired">

						<div class="weui-cell weui-cell_switch">
							<div class="weui-cell__bd">
								<input class="weui-input" type="text" placeholder="信息项名称" v-model="infoCollectThreeName">
							</div>
							<div class="weui-cell__ft">
								<label class="v-a-super">必填项</label>
								<input class="weui-switch" type="checkbox" v-model="infoCollectThreeIsRequired">
							</div>
						</div>

						<div class="weui-cell weui-cell_switch">
							<div class="weui-cell__bd">
								<input class="weui-input" type="text" placeholder="信息项名称" v-model="infoCollectFourName">
							</div>
							<div class="weui-cell__ft">
								<label class="v-a-super">必填项</label>
								<input class="weui-switch" type="checkbox" v-model="infoCollectFourIsRequired">
							</div>
						</div>

						<div class="weui-cell weui-cell_switch">
							<div class="weui-cell__bd">
								<input class="weui-input" type="text" placeholder="信息项名称" v-model="infoCollectFiveName">
							</div>
							<div class="weui-cell__ft">
								<label class="v-a-super">必填项</label>
								<input class="weui-switch" type="checkbox" v-model="infoCollectFiveIsRequired">
							</div>
						</div>

					</div>
					<div id="addInfoItem" class="add-info-item">

					</div>

				</div>
			</div>

			<div class="form-handle">
				<div class="mode">
					<div class="weui-cell weui-cell_switch">

						<div class="weui-cell__ft">
							<label>编辑模式</label>
							<input class="weui-switch" type="checkbox" @change="switchMode">
							<label>预览模式</label>
						</div>
					</div>
				</div>
				<div class="save" @click="publishActivity">
					发布活动
				</div>
			</div>

			<div id="sourceHandle" class="weui-popup__container popup-bottom">
				<div class="weui-popup__overlay"></div>
				<div class="weui-popup__modal">

					<div class="weui-grids">
						<a @click="popupSourceHandle(1,'instead','img')" href="javascript:;" class="weui-grid js_grid" data-id="dialog">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_dialog.png" alt="">
							</div>
							<p class="weui-grid__label">
								替换图片
							</p>
						</a>
						<a @click="popupSourceHandle(2,'instead','txt')" href="javascript:;" class="weui-grid js_grid" data-id="progress">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_progress.png" alt="">
							</div>
							<p class="weui-grid__label">
								替换文字
							</p>
						</a>
						<!--<a @click="popupSourceHandle(3,'instead','video')" href="javascript:;" class="weui-grid js_grid" data-id="msg">
              <div class="weui-grid__icon">
                <img src="images/icon_nav_msg.png" alt="">
              </div>
              <p class="weui-grid__label">
                替换视频
              </p>
            </a>-->
						<a @click="popupSourceHandle(4,'insert','img')" href="javascript:;" class="weui-grid js_grid" data-id="dialog">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_dialog.png" alt="">
							</div>
							<p class="weui-grid__label">
								插入图片
							</p>
						</a>
						<a @click="popupSourceHandle(5,'insert','txt')" href="javascript:;" class="weui-grid js_grid" data-id="progress">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_progress.png" alt="">
							</div>
							<p class="weui-grid__label">
								插入文字
							</p>
						</a>
						<!--<a @click="popupSourceHandle(6,'insert','video')" href="javascript:;" class="weui-grid js_grid" data-id="msg">
              <div class="weui-grid__icon">
                <img src="images/icon_nav_msg.png" alt="">
              </div>
              <p class="weui-grid__label">
                插入视频
              </p>
            </a>
            -->
						<a @click="popupSourceHandle(7,'clear')" href="javascript:;" class="weui-grid js_grid" data-id="msg">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_msg.png" alt="">
							</div>
							<p class="weui-grid__label">
								删除内容
							</p>
						</a>

					</div>
				</div>
			</div>

			<!--替换banner-->
			<div id="select_banner" class="weui-popup__container popup-bottom">
				<div class="weui-popup__overlay"></div>
				<div class="weui-popup__modal">

					<div class="weui-grids">
						<a @click="use_style()" href="javascript:;" class="weui-grid js_grid" data-id="dialog">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_dialog.png" alt="">
							</div>
							<p class="weui-grid__label">
								默认风格
							</p>
						</a>
						<a @click="use_style(1)" href="javascript:;" class="weui-grid js_grid" data-id="progress">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_progress.png" alt="">
							</div>
							<p class="weui-grid__label">
								风格一
							</p>
						</a>
						<a @click="use_style(2)" href="javascript:;" class="weui-grid js_grid" data-id="msg">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_msg.png" alt="">
							</div>
							<p class="weui-grid__label">
								风格二
							</p>
						</a>
						<a @click="use_style(3)" href="javascript:;" class="weui-grid js_grid" data-id="dialog">
							<div class="weui-grid__icon">
								<img src="images/icon_nav_dialog.png" alt="">
							</div>
							<p class="weui-grid__label">
								风格三
							</p>
						</a>

					</div>

				</div>
			</div>

		</div>

		<div id="uploadImg" class="weui-popup__container">
			<div class="weui-popup__overlay"></div>
			<div class="weui-popup__modal">

				<!--<div id="uploadImgTool" class="demo"></div>-->

				<!--<form id='add' enctype="multipart/form-data" >
	111
		<input type="text" name='book'/>
		<input id="avatar" type="file" name='source' value="上传33"/>
		<input id="ee" value="button" type="button"/>
</form>
 <form enctype="multipart/form-data" method="post" action="http://g1u8257706.iask.in/shopCut/uploadImage?unique=pic1&shopUserId=15&section=1&activityTypeId=2">
    图片<input  type="file" name="file"/>
    <input type="submit" value="上传"/ >
</form>-->
				<img class="preview-upload-img" src="" alt="" />
				<form id="uploadFileForm" enctype="multipart/form-data" method="post" name="fileinfo">

					<input type="hidden" name="unique" /><br />
					<input type="hidden" name="activityTypeId" /><br />
					<input type="hidden" name="shopUserId" /><br />
					<input type="hidden" name="section" /><br />

					<!--  <input id="uploadFile" type="file" name="file" onchange="imgPreview(this)" required />
  <input type="submit" value="确认上传" />-->

					<div class="uploader blue">
						<input type="text" class="filename" readonly="readonly" />
						<input type="button" name="file" class="select-upload-file" value="选择图片" />
						<input id="uploadFile" type="file" name="file" size="30" onchange="imgPreview(this)" />

						<input type="submit" value="确认上传" />
					</div>

				</form>

				<div class="btns">
					<a href="javascript:;" class="weui-btn weui-btn_primary close-popup" onclick="activity.sureSubmitImg()">确认</a>
					<a href="javascript:;" class="weui-btn weui-btn_primary close-popup bg_#bdbdbd">取消</a>
				</div>

			</div>
		</div>

		<div id="uploadVideo" class="weui-popup__container">
			<div class="weui-popup__overlay"></div>
			<div class="weui-popup__modal">
				<img src="" alt="" />
				<form id="uploadVideoForm" enctype="multipart/form-data" method="post" name="fileinfo">

					<input type="hidden" name="unique" /><br />
					<input type="hidden" name="activityTypeId" /><br />
					<input type="hidden" name="shopUserId" /><br />
					<input type="hidden" name="section" /><br />

					<div class="uploader blue">
						<input type="text" class="filename" readonly="readonly" />
						<input type="button" name="file" class="select-upload-file" value="选择视频" />
						<input id="uploadVideo" type="file" name="file" size="30" />

						<input type="submit" value="确认上传" />
					</div>
				</form>

				<!--<a href="javascript:;" class="weui-btn weui-btn_primary close-popup" onclick="activity.sureSubmitVideo()">确认提交</a>-->

				<a href="javascript:;" class="weui-btn weui-btn_primary close-popup bg_#bdbdbd">取消</a>

			</div>
		</div>

		<div id="addTxt" class="weui-popup__container">
			<div class="weui-popup__overlay"></div>
			<div class="weui-popup__modal">

				<div id="txtEditTool" class="">

				</div>

				<div class="btns">
					<a href="javascript:;" class="weui-btn weui-btn_primary close-popup" onclick="activity.sureSubmitTxt()">确认提交</a>
					<a href="javascript:;" class="weui-btn weui-btn_primary close-popup bg_#bdbdbd">取消</a>
				</div>
			</div>
		</div>

		<input type="hidden" id="curSourceId" value="" />
		<input type="hidden" id="handleName" value="" />
		<!--单次资源操作状态-->
		<input type="hidden" id="handleType" value="" />
		<!--资源类别-->
		<input type="hidden" id="sourceType" value="" />
		<!--当前section id-->
		<input type="hidden" id="sectionType" value="" />

		<!--<div id="new_img" class="img" >
		<img data-index-id="" src="" alt="" />
	</div>
	<div id="new_txt" class="txt">
		<p data-index-id=""></p>
	</div>
	<div id="new_video" class="video">
		<video data-index-id="" src=""></video>
	</div>-->



		<div id="txt_css_render" class="txt-css">
			<p class="item1 item">
				<a style="font-weight: bold;" >B（加粗）</a>
				<a style="font-style: italic;">I（斜体）</a>
				<a style="text-decoration: underline;" >U（下划线）</a>
				<a style="text-decoration: line-through;" >L（删除线）</a>
			</p>
			<p class="item2 item">
				
				<label for="">文字大小</label>
				<span>-</span>
				<input type="range" min="12" max="50" step="1" value="12"   onchange="txt_css_render.BASE.get_txt_font_size_css(this.value)">
				<span>+</span>		
			</p>
			<p class="item3 item">				
				<label for="">字体</label>
				<span><a style="font-family: '宋体';" >宋体</a></span>
				<span><a style="font-family: '微软雅黑';" >微软雅黑</a></span>
				<span><a style="font-family: '黑体';" >黑体</a></span>
				<span><a style="font-family: '楷体';" >楷体</a></span>
				<span id="more_font_famliy">更多</span>
				<div class="font-warehouse hide">
					<div><a style="font-family: '宋体';" >宋体</a></div>
					<div><a style="font-family: '微软雅黑';" >微软雅黑</a></div>
					<div><a style="font-family: '黑体';" >黑体</a></div>
					<div><a style="font-family: '细明体';">细明体</a></div>
					<div><a style="font-family: '标楷体';" >标楷体</a></div>
					<div><a style="font-family: '微软正黑体';" >微软正黑体</a></div>
				</div>	
			</p>
			<p class="item4 item">				
				<label for="">颜色</label>
				<span class="color-slot" style="color:red;background-color: red;"><a style="color: red;" ></a></span>
				<span class="color-slot"  style="color:blue;background-color: blue;"><a style="color: blue;" ></a></span>
				<span class="color-slot"  style="color:green;background-color: green;"><a style="color: green;" ></a></span>
				<span class="color-slot"  style="color:yellow;background-color: yellow;"><a style="color: yellow;" ></a></span>
				<span id="more_color_slot">更多</span>
				<div class="color-slots hide">
						<a style="color: red;" ><div style="color:red;background-color: red;"></div></a>
						<a style="color: blue;" ><div style="color:blue;background-color: blue;"></div></a>
						<a style="color: green;" ><div style="color:green;background-color: green;"></div></a>
						<a style="color: yellow;" ><div style="color:yellow;background-color: yellow;"></div></a>
						<input type="text" id="pick_color" class="demo" data-control="hue" value="#000">
					</div>
			
				</p>	
				<p class="hide-panel">
					<span>收起</span>
				</p>
					
			</div>	
			
			
			
			
		</div>
		
		<script type="text/javascript">
			var txt_css_render = {
				BASE:{
					cur_textarea:'',
					final_css:{
						'font-size':'',
						'font-weight':'',
						'font-style':'',
						'text-decoration':'',
						'font-size':'',
						'font-family':'',
						'color':'',
						'width':'100%',
						 'resize': 'none'
					},
					init:function(){
						
						
						this.bind_get_css_event();
						this.bind_textarea();
						this.bind_more();
						this.load_minicolors();
						this.bind_other();
					},
					get_txt_font_size_css:function(val){
						txt_css_render.BASE.final_css['font-size'] = (val+'px');
						txt_css_render.BASE.refresh_css();
					},
					load_minicolors:function(){
						$('#pick_color').minicolors({
							 change: function(value, opacity) {
							 	
					            txt_css_render.BASE.final_css['color'] = value;
					            txt_css_render.BASE.refresh_css();
					          },
						});
					},
					bind_get_css_event:function(){
						$("#txt_css_render a").off();
						
						$("#txt_css_render a").click(function(e){
							//$(this).parent().find(".selected-item").removeClass("selected-item");
							debugger;
							if($(this).parent().hasClass("item1")){
								if($(this).hasClass("selected-item")){
									$(this).removeClass("selected-item");
									
									var css = $(this).attr("style");
									css = css.split(";")[0];
									txt_css_render.BASE.final_css[css.split(":")[0]] = "";
									
									txt_css_render.BASE.refresh_css();
								}
								else{
									$(this).addClass("selected-item");
									
									var css = $(this).attr("style");
									css = css.split(";")[0];
									txt_css_render.BASE.final_css[css.split(":")[0]] = css.split(":")[1];
									
									txt_css_render.BASE.refresh_css();
									
								}
							}
							else{
								  $(this).parent().siblings().children().removeClass("selected-item");
								  $(this).addClass("selected-item");
	
									var css = $(this).attr("style");
									css = css.split(";")[0];
									txt_css_render.BASE.final_css[css.split(":")[0]] = css.split(":")[1];
									
									txt_css_render.BASE.refresh_css();
							}
							
							
							
						
						})
					},
					bind_other:function(){
						$(".hide-panel").click(function(e){
							$("#txt_css_render").slideUp();
						})			
					},
					bind_textarea:function(){
						$("textarea").focus(function(e){
							txt_css_render.BASE.cur_textarea = $(this);
							$("#txt_css_render").slideDown();
						})

						$('textarea').each(function () {
						  this.setAttribute('style', 'height:' + (this.scrollHeight) + 'px;overflow-y:hidden;');
						}).on('input', function () {
						  this.style.height = 'auto';
						  this.style.height = (this.scrollHeight) + 'px';
						});
						
					},
					bind_more:function(){
						$("#more_font_famliy").off();
						$("#more_color_slot").off();
						
						$("#more_font_famliy").click(function(e){
							$(".font-warehouse").fadeToggle("hide")
						})
						$("#more_color_slot").click(function(e){
							$(".color-slots").fadeToggle("hide")
						})
					},
					refresh_css:function(){
						var style_str = '';
						for(var i in txt_css_render.BASE.final_css){
							style_str += (i+":"+txt_css_render.BASE.final_css[i]+";");
						}
						
						txt_css_render.BASE.cur_textarea.attr("style",style_str);
					},
				}
			}
			
			txt_css_render.BASE.init()
		</script>

		<script src="../js/libs/weui/fastclick.js"></script>

		<script>
			/*  $(function() {
			    FastClick.attach(document.body);
			  });*/
		</script>
		<script src="../js/libs/weui/jquery-weui.js"></script>

		<script>
			var activityVue = new Vue({
				el: '#activityVue',
				data: {

					preview_init_price: '',
					preview_new_price: '',

					//提交表单’
					//activityStartTime:'',
					//activityEndTime:'',
					headId: BASE_UTIL.get_url_param('activityType') + BASE_UTIL.get_url_param('activityTypeId'),
					headUrl: '../images/activity/' + BASE_UTIL.get_url_param('activityType') + "/" + BASE_UTIL.get_url_param('activityType') + BASE_UTIL.get_url_param('activityTypeId') + ".jpg",

					shopUserId: BASE_UTIL.get_url_param('shopUserId'),
					activityTypeId: BASE_UTIL.get_url_param('activityTypeId'),
					activityType: BASE_UTIL.get_url_param('activityType'),
					title: '',

					cutOriginPrice: '',
					cutLeastPrice: '',
					cutLeastPerPerson: '',
					cutMostPerPerson: '',
					redoHours: '',

					infoCollectOneName: '姓名',
					infoCollectOneIsRequired: 2,
					infoCollectTwoName: '手机',
					infoCollectTwoIsRequired: 2,
					infoCollectThreeName: '',
					infoCollectThreeIsRequired: '',
					infoCollectFourName: '',
					infoCollectFourIsRequired: '',
					infoCollectFiveName: '',
					infoCollectFiveIsRequired: '',

					prizeNumber: '',

					sectionOneName: '奖品描述',
					sectionTwoName: '活动规则',
					sectionThreeName: '领奖信息',
					sectionFourName: '机构介绍',

					consultPhoneNumber: '',

					curSourceId: '',
					curSourceIndex: '',
					curSourceType: '',
					curSectionType: '',
					handleType: '',
					skinId: 0,

					upload_response_data: ''
				},
				methods: {
					use_style: function(type) {
						debugger

						this.headUrl = '../images/activity/' + BASE_UTIL.get_url_param('activityType') + "/" + BASE_UTIL.get_url_param('activityType') + BASE_UTIL.get_url_param('activityTypeId') + (!!type ? "_" + type : '') + ".jpg",
							LAYOUT.render_css(BASE_UTIL.get_url_param('activityTypeId'), type);
						this.skinId = type;
					},
					submit: function(event) {
						debugger
						this.info.province = $("#selectArea").val().split(" ")[0];
						this.info.city = $("#selectArea").val().split(" ")[1];
						var data = this.info;
					},
					publishActivity: function() {
						debugger;
						var data = this.$data;
						//data.headId = $("#head_banner .source").attr("id");
						data.headId = 1;
						data.activityStartTime = $("#startTime").val();
						data.activityEndTime = $("#endTime").val();
						data.sectionOneArrayIndex = activity.sectionSourceIndex['#section_1'].join(",");
						data.sectionTwoArrayIndex = activity.sectionSourceIndex['#section_2'].join(",");
						data.sectionThreeArrayIndex = activity.sectionSourceIndex['#section_3'].join(",");
						data.sectionFourArrayIndex = activity.sectionSourceIndex['#section_4'].join(",");
						
						
	
		
						data.infoCollectThreeIsRequired=data.infoCollectThreeIsRequired?2:1;
		
						data.infoCollectFourIsRequired=data.infoCollectFourIsRequired?2:1;
				
						data.infoCollectFiveIsRequired= data.infoCollectFiveIsRequired?2:1;

						this.$nextTick(function() {
							//拼接html描述文本
							$(".source .txt").each(function(index, item) {
								var id = $(item).parent().attr("id");
								var content = $(item).html();
								data[id] = content;
							})

							activity.sumbit(data);
						})

					},
					switchMode: function() {

						$("#section_top").toggleClass("preview");
						
						$("#section_0").toggleClass("preview");

						$("#section_1").toggleClass("preview");
						
						$(".t-i-007").toggleClass("edit-title");

						$(".module .content .source").toggleClass("preview");
						$(".module .content .source .hand-trigger").toggleClass("preview");
						$(".upload-panel").toggleClass("preview");
						
						$(".count-down,.main-title").toggleClass("preview");
						
						$('#count_down').downCount({
				            date: $("#endTime").val(),
				            offset: +10
				        }, function () {
				            alert('倒计时结束!');
				        });
						
						
					},
					refreshRelativeValues: function(name, value) {
						this[name] = value;
						//this.$set(this.source.setting.value4,value-1);
						//this.$set(this.source.setting.value5,((value-1)*0.5).toFixed(0));
					},
					initCountDown: function(value) {
						this.$nextTick(function() {
							activity.renderCountDown(value)
						})
					},

					popupSourceHandle: function(handleType, handleName, sourceType, sectionType) {
						debugger
						this.markHandle(handleName, sourceType, sectionType);

						this.handleType = handleType;
						this.$nextTick(function() {
							$.closePopup();

							if($.inArray(handleType, [1, 3, 4, 6]) != -1) {
								$("#uploadImg").popup();

								var obj = document.getElementById('uploadFile');
								obj.outerHTML = obj.outerHTML;
							}
							/*if($.inArray(handleType, [2, 5]) != -1) {
								$("#addTxt").popup();
								$("#txtEditTool").load("textEditer.html");

							}*/
							if(handleType == 7) {
								debugger;
								var id = $("#curSourceId").val();
								$("#" + $("#curSourceId").val()).remove();

								$("#curSourceId").val('');
								var st = activityVue.curSourceType;
								var sty = activityVue.curSectionType;
								if(st == "img") {
									activity.sectionSourceIndex[sty].splice(activity.sectionSourceIndex[sty].indexOf(id), 1);

								}
								if(st == "txt") {
									activity.sectionTxtLength[sty]--;
									activity.sectionTxtLength[sty].splice(activity.sectionTxtLength[sty].indexOf(id), 1);

									activity.refreshAllTxtId(sectionType);
								}
								if(st == "video") {
									activity.sectionSourceIndex[sty].splice(activity.sectionSourceIndex[sty].indexOf(id), 1);

								}
								alert(activity.sectionSourceIndex[sty]);

							}

						})

					},
					markHandle: function(handleName, sourceType, sectionType) {
						//$
						debugger
						this.curSourceType = $("#sourceType").val();
						this.curSectionType = $("#sectionType").val();
						$("#handleName").val(handleName);
						$("#sourceType").val(sourceType);
						$("#sectionType").val(sectionType || $("#sectionType").val());

						if(handleName == "add") {
							$("#curSourceId").val('');
						}

						if(sourceType == "txt") {
							//$("#txtEditTool").load("textEditer.html");
							
							var dom =  "<div id=\"#id\" class=\"source\"><div onclick=\"activity.editSourceItem(#id)\"class=\"hand-trigger open-popup\"data-target=\"#sourceHandle\">编辑</div><div class=\"txt\"><p><textarea value=\"请输入\">请输入</textarea></p></div></div>";

							var stJqId = $("#sectionType").val();
							
							
							var ht = $("#handleName").val();
							var st = $("#sourceType").val();
							var csId = $("#curSourceId").val();

							
							dom = dom.replace(/#id/g, activity.handleTxtSourceIndex(csId, ht, stJqId))
							
							$(stJqId).find(".upload-panel").before(dom);
							
							txt_css_render.BASE.init();
							
							
						}
						/*if($.inArray(sectionType, activity.hasSourceSection)!=-1){
							
						}*/

					},
					toggle_warhouse: function() {
						//$
						debugger
						$(".font-warehouse").toggleClass("hide")

					},
				}
			})

			var activity = {
				imgSourceLength: 0,
				videoSourceLength: 0,
				sectionTxtLength: {
					'#section_1': 1,
					'#section_2': 1,
					'#section_3': 1,
					'#section_4': 1,
				},
				hasSourceSection: ['#section_1', '#section_2', '#section_3', '#section_4'],
				sectionSourceIndex: {
					'#section_1': [],
					'#section_2': [],
					'#section_3': [],
					'#section_4': [],
				},

				tem: {
					img: "<div id=\"#id\" class=\"source\"><div onclick=\"activity.editSourceItem(#id)\"class=\"hand-trigger open-popup\"data-target=\"#sourceHandle\">编辑</div><div src=\"#content\" class=\"img\"><img src=\"#content\"alt=\"\"/></div></div>",
					txt: "<div id=\"#id\" class=\"source\"><div onclick=\"activity.editSourceItem(#id)\"class=\"hand-trigger open-popup\"data-target=\"#sourceHandle\">编辑</div><div class=\"txt\"><p>#content</p></div></div>",
					video: "<div id=\"#id\" class=\"source\"><div onclick=\"activity.editSourceItem(#id)\"class=\"hand-trigger open-popup\"data-target=\"#sourceHandle\">编辑</div><div class=\"video\"><video src=\"#content\"></video></div></div>",
				},

				sourceTypeMap: {

				},
				/*get_head_banner: function () {

						request.postData({
		            url: urlConfig.submitActivityUrl,
		            param: param
		        }).then(function(data) {
		        	debugger;
		        	
		        }, function(err) {
		            console.log(err);
		        });
		    },*/
				editSourceItem: function(o) {

					//this.curSourceIndex = source.index;
					//this.curSourceType = source.type;
					debugger
					$("#curSourceId").val($(o).attr("id"));
				},
				renderCountDown: function(value) {
					var time = value.split(" ")[1];
					var dateTime = value.split(" ")[0];
					dateTimes = dateTime.split("-");
					dateTime = dateTimes[1] + "/" + dateTimes[2] + "/" + dateTimes[0] + " " + time + ":00";
					$('.countdown').downCount({
						date: dateTime,
						offset: +10
					}, function() {
						alert('倒计时结束!');
					});
				},
				refreshAllTxtId: function(sectionType) {
					var indexs = this.sectionSourceIndex[sectionType];
					var newIndexs = [];
					indexs.forEach(function(o, index) {
						var obj = '';
						index++;
						if(o.split("_")[1].substr(0, 3) == 'txt') {
							obj = sectionType + "_txt" + index;
						}
						$("#").attr("id", obj);
						newIndexs.push(obj);
					})
				},
				init: function() {

					LAYOUT.render_css(BASE_UTIL.get_url_param('activityTypeId'));

					$("#startTime").datetimePicker();
					$("#endTime").datetimePicker();

					//上传表单初始化值
					$("form input[name='shopUserId']").val(BASE_UTIL.get_url_param('shopUserId'));
					$("form input[name='activityTypeId']").val(BASE_UTIL.get_url_param('activityTypeId'));

					//activityVue.initCountDown();

					/*$('#bottomPrice').slider(function (percent) {
				     	activityVue.preview_new_price = percent
				  })
    			 $('#perCutMax').slider(function (percent) {
				     
				  })
    			 $('#perCutMin').slider(function (percent) {
				     
				  })*/

				},
				sumbit: function(param) {
					request.postData({
						url: urlConfig.submitActivityUrl,
						param: param
					}).then(function(data) {
						debugger;

						$.toast("发布成功", function() {
							location.href = "view_activity.html?shopUserId=" + activityVue.shopUserId +
								"&shopUserActivityId=" + data.shopUserActivityId +
								"&activityTypeId=" + activityVue.activityTypeId +
								"&activityType=" + activityVue.activityType;
						});
					}, function(err) {
						console.log(err);
					});

				},
				/*change_banner:function (param) {    	 
					$("#uploadBanner").click();
					
					$("#previewBanner").add("#uploadBannerForm").removeClass("hide");
					$("#defaultBanner").addClass("hide")
		    },*/
				handleImgSourceIndex: function(addSourceIds, curSourceId, handleName, sectionType) {
					debugger;

					var indexs = this.sectionSourceIndex[sectionType] || [];
					if(handleName == 'add') {
						indexs.push.apply(indexs, addSourceIds);
					}
					if(handleName == 'instead') {
						indexs.splice(indexs.indexOf(curSourceId), 1, addSourceIds);
					}
					this.sectionSourceIndex[sectionType] = indexs;
					//alert(this.sectionSourceIndex[sectionType]);

				},

				handleTxtSourceIndex: function(curSourceId, handleName, sectionType) {

					var txtId = '';
					var len = this.sectionTxtLength[sectionType];
					var indexs = this.sectionSourceIndex[sectionType] || [];

					if(handleName == 'add' || curSourceId.substr(0, 7) != 'section') {
						txtId = "s" + sectionType.split("_")[1] + "t" + len;
						indexs.push(txtId);
						len++;
					}
					this.sectionTxtLength[sectionType] = len;
					this.sectionSourceIndex[sectionType] = indexs;
					return txtId;

				},
				sureSubmitTxt: function() {
					//$
					debugger;
					var ht = $("#handleName").val();
					var st = $("#sourceType").val();
					var stJqId = $("#sectionType").val();
					var csId = $("#curSourceId").val();

					var html = $("#froalaEditorWrap .fr-element").html();
					var dom = this.tem[st];

					dom = dom.replace(/#id/g, this.handleTxtSourceIndex(csId, ht, stJqId))
					dom = dom.replace(/#content/g, html);
					//add

					if(ht == 'add') {

						$(stJqId).find(".upload-panel").before(dom);
					}

					//insert
					if(ht == 'insert') {
						$("#" + csId).after(dom);
					}
					//instead
					if(ht == 'instead') {
						$("#" + csId).replaceWith(dom);
					}

				},

				sureSubmitVideo: function() {
					var _this = this;

					var data = {}
					/*data.list = [{
									id:'pic1',
									url:'../demo/source/1.mp4'
								}]*/
					data.list = activityVue.upload_response_data.src;

					var ht = $("#handleName").val();
					var st = $("#sourceType").val();
					var stJqId = $("#sectionType").val();
					var csId = $("#curSourceId").val();

					var addSourceIds = [];

					var dom = '';
					data.list.forEach(function(o) {
						var d = _this.tem[st];
						debugger
						//var newId = "video"+activity.videoSourceLength;
						d = d.replace(/#id/g, o.id)
						d = d.replace(/#content/g, o.url)
						dom += d;
						addSourceIds.push(o.id);
						activity.videoSourceLength++;

					})

					//add
					if(ht == 'add') {

						$(stJqId).find(".upload-panel").before(dom);

					}

					//insert
					if(ht == 'insert') {
						$("#" + csId).after(dom);
					}
					//instead
					if(ht == 'instead') {
						$("#" + csId).replaceWith(dom);
					}
					_this.handleImgSourceIndex(addSourceIds, csId, ht, stJqId);
					/*request.postData({
            url: urlConfig.registerUrl,
            param: ''
	        }).then(function(data) {
	        	
	        	
	
	        }, function(err) {
	            console.log(err);
	        });*/

				},
				sureSubmitImg: function() {
					var _this = this;

					var data = {}
					/*data.list = [{
									id:'pic1',
									url:'../images/demo/upload_success_1.jpg'
								},
								{
									id:'pic2',
									url:'../images/demo/upload_success_2.jpg'
								}]*/
					data.list = activityVue.upload_response_data.src;

					var ht = $("#handleName").val();
					var st = $("#sourceType").val();
					var stJqId = $("#sectionType").val();
					var csId = $("#curSourceId").val();

					var addSourceIds = [];

					var dom = '';
					data.list.forEach(function(o) {
						var d = _this.tem[st];
						debugger
						//var newId = "img"+activity.imgSourceLength;
						d = d.replace(/#id/g, o.id)
						d = d.replace(/#content/g, o.url)
						dom += d;
						addSourceIds.push(o.id);
						activity.imgSourceLength++;

					})

					//add
					if(ht == 'add') {

						$(stJqId).find(".upload-panel").before(dom);

					}

					//insert
					if(ht == 'insert') {
						$("#" + csId).after(dom);
					}
					//instead
					if(ht == 'instead') {
						$("#" + csId).replaceWith(dom);
					}
					_this.handleImgSourceIndex(addSourceIds, csId, ht, stJqId);
					/*request.postData({
            url: urlConfig.registerUrl,
            param: ''
	        }).then(function(data) {
	        	
	        	
	
	        }, function(err) {
	            console.log(err);
	        });*/

				}

			}
			activity.init();

			var form = document.forms.namedItem("fileinfo");
			form.addEventListener('submit', function(ev) {

				var ht = $("#handleName").val();
				var st = $("#sourceType").val();
				var stJqId = $("#sectionType").val();
				var csId = $("#curSourceId").val();

				var newId = "pic" + activity.imgSourceLength;

				$("form input[name='unique']").val(newId);
				$("form input[name='section']").val(stJqId.split("_")[1]);

				oData = new FormData(form);

				//oData.append("unique", "pic1");`
				//oData.append("activityTypeId", 2);
				// oData.append("section", 1);
				// oData.append("shopUserId", 15);
				var oReq = new XMLHttpRequest();
				oReq.open("POST", "http://g1u8257706.iask.in/shopCut/uploadImage", true);
				oReq.onload = function(oEvent) {
					if(oReq.status == 200) {
						debugger;
						activityVue.upload_response_data = JSON.parse(oReq.responseText);

						$.toptip('上传成功', 'success');
						//activity.sureSubmitImg();
					} else {
						alert("上传失败：" + oReq.status);
					}
				};

				oReq.send(oData);
				ev.preventDefault();
			}, false);

			function imgPreview(fileDom) {
				//判断是否支持FileReader
				if(window.FileReader) {
					var reader = new FileReader();
				} else {
					alert("您的设备不支持图片预览功能，如需该功能请升级您的设备！");
				}

				//获取文件
				var file = fileDom.files[0];
				var imageType = /^image\//;
				//是否是图片
				if(!imageType.test(file.type)) {
					alert("请选择图片！");
					return;
				}
				//读取完成
				reader.onload = function(e) {
					$(fileDom).parent().parent().prev().attr("src", e.target.result);
				};
				reader.readAsDataURL(file);
			}

			$("#uploadVideoForm").submit(function(ev) {
				var ht = $("#handleName").val();
				var st = $("#sourceType").val();
				var stJqId = $("#sectionType").val();
				var csId = $("#curSourceId").val();

				var newId = "m" + activity.videoSourceLength;

				$(this).find("form input[name='unique']").val(newId);
				$(this).find("form input[name='section']").val(stJqId.split("_")[1]);

				var oReq = new XMLHttpRequest();
				oReq.open("POST", urlConfig.uploadMedia, true);
				oReq.onload = function(oEvent) {
					if(oReq.status == 200) {
						$.toptip('上传成功', 'success');
					} else {
						alert("上传失败：" + oReq.status);
						//oOutput.innerHTML = "Error " + oReq.status + " occurred when trying to upload your file.<br \/>";
					}
					oReq.send(new FormData(_this));
					ev.preventDefault();

				}

			});

			/*uploadUtil.init_event_render("#uploadVideoForm",{
				url:urlConfig.uploadMedia,
				callback:function(){
					$.toptip('上传成功', 'success');
					activity.sureSubmitVideo();
				}
			});*/
			$(function() {
				
				
				$("input[type=file]").change(function() {
					$(this).parents(".uploader").find(".filename").val($(this).val());
				});
				$("input[type=file]").each(function() {
					if($(this).val() == "") {
						$(this).parents(".uploader").find(".filename").val("尚未选择文件...");
					}
				});
			});
		</script>
	</body>

</html>